# 一个可可爱爱没有脑袋的食堂预约系统

我们的定位是EE，easy and efficient。

## 背景

疫情下的数字化潮流不必多说，随着人们对这一领域的关注越来越多，理所应当地数字化代替线下活动的可扩展空间越来越小，几乎在所有能够用数字化做到部分代替的方向，都出现了傲视群雄的领军产品。

有些方面，他们真的已经做得很好了。但是有些还不够，而且就在我们身边。

在数字化高速发展应用的今天，高校学生却还是需要冒着受感染的风险，每天多次往返人口集中地区。食堂，操场，只要出现一个感染者，那就是全校的灾难。鼓励外提本是一个有效的应对，但由于缺少配套措施而难以发挥。

所以，我们决定做一个配套措施。

## 项目简介

食堂预约系统。言简意赅一目了然。

食堂的人流量有一个明显的高峰期。这和我校的课程结构有关，11：10-12：00为最后一节课。人们对午饭的期望时间大多集中在11：30左右，于是上午最后一节课下课的同学大部分都会选择来食堂，同时11：30-12：00也是人们传统的午餐时间。上述一系列的原因导致11：30开始食堂几乎是饱和的状态，而11：30之前却只有寥寥数人。这样，时间得不到充分的利用，后果就是浪费学生的时间，增加传染的风险，食堂师傅也会在特定时间很累。

于是，就像IEEE754标准中处理0的方法一样，我们也可以想方法把稠密的人流给拉开、摊平、踩扁。

这是食堂预约系统的初衷。通过简化点餐取餐流程以期减小人口密度从而降低人口密度，是鼓励外提的最佳实践者。

## 功能

平台开放时间有一定的限制。在配套设施不够齐全的情况下，本平台不能较好地处理堂食和外带的冲突，因此可以选择在高峰期前开放预约，当现场排队人数多起来时关闭预约。

我们的平台中主要有两种角色，学生，店铺。

### 学生

学生是本平台的主要用户群体。

学生可以在大厅浏览主要菜品，决定之后下单预约，选择特定的取餐时间来食堂窗口凭借取餐码取餐。

取餐时间在每个时间段内有限制人数。这决定了这个系统不可能解决所有人的排队问题，但是可以减轻它的严重性。

### 店铺

店铺是本平台的主要服务提供者。

店铺在验证通过的情况下可以上市，自由选择开店关店时间。当然其所在食堂的限制是必须考虑的。

店铺可以添加自己的菜品，其中最重要的属性是最大预约数和菜品完成周期。

通过某种算法，我们可以根据上述的属性来设计出一个相对来说比较合理的任务列表供店铺参考。如果店铺遵循此任务列表，可能可以达到较好的分配做菜时间的效果。算法介绍见下文。

## 技术实现

选择`spring boot`作为后端框架和`vue`作为前端框架。

## 亮点

本平台亮点在于实现了一个分配任务的算法。

算法本身并不复杂，但是可以达到较好的利用时间的效果。

当每份订单都选择了取餐时间，那就是在时间轴上插了一个个标签；每一份订单由一定数量的菜品组成，菜品有完成周期这个属性，也就意味着每份订单的时间可以被大致估算，在时间轴上显示，就是以标签为右边界的一个个矩形。我们要做的就是把这一个矩形排列好，尽量让他们没有重叠或者是重叠次数小于某个值，且右边界（最晚完成时间）早于取餐时间又不至于早太多。原则上最晚完成时间不得晚于预定取餐时间。

算法的简单流程如下：

- 订单先找到自己的取餐时间所在点，例如11：50
- 然后根据`店铺最多可同时工作的人的数量`a以及`菜品周期`b，如果和别的订单时间域最大重叠次数超过a，则将该订单前移，一直移到重叠次数小于a为止

这是一种比较简单的实现，在取餐时间段有预约人数限制的情况下我们不考虑最坏情况，所以大体上性能可观。当然还有其中还有可以使总体更优的算法我们暂时没有考虑。

这种算法还有一个直觉上的认知：当没有预定系统的时候通过排队可以让大量的人在1个小时之内打完饭，那么经过人工分配至少状况可以变得更好，且不会出现打不完饭的情况。

## 鼓励外提

这种平台不仅可以降低高峰期食堂的人口密度，同样可以成为鼓励外提的实践者。

曾经在食堂买一份饭可能需要10分钟左右的等待，但是现在却几乎可以到了就提走，那么自然留在食堂就餐的欲望减小，更多人应该会选择拿了便离开。

同时，鼓励外提也是高校本身应该支持的方向，所以本平台不足之处比如极端情况下饭菜可能会凉，若由学校提供配套设施，应该会很好解决。

## 展望

目前的代码只能作为一个demo，但若充分扩展充分支持，各种食堂在本平台的帮助下的效率都可能会得到较大的提升，从而降低人口密度和感染风险。

由此，本项目虽然没有特别复杂的技术栈，但我认为它充分体现了EE，即easy and efficient原则。代码本就以简单高效为佳。


